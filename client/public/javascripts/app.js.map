{"version":3,"sources":["app/application.coffee","app/initialize.coffee","app/lib/app_helpers.coffee","app/lib/base_view.coffee","app/lib/client.coffee","app/lib/view_collection.coffee","app/router.coffee","app/views/app_view.coffee","app/views/page_view.coffee","app/views/templates/home.jade","app/views/templates/page.jade"],"names":[],"mappings":"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","file":"public/javascripts/app.js","sourcesContent":["module.exports =\n\n    initialize: ->\n        # Used in inter-app communication\n        #SocketListener = require '../lib/socket_listener'\n\n        # Routing management\n        Router = require 'router'\n        @router = new Router()\n        Backbone.history.start()\n\n        # Makes this object immuable.\n        Object.freeze this if typeof Object.freeze is 'function'","app = require 'application'\n\n# The function called from index.html\n$ ->\n    require 'lib/app_helpers'\n\n    app.initialize()","(() ->\n    # IIFE to avoid collisions with other variables\n    (->\n        # Make it safe to do console.log() always.\n        console = window.console = window.console or {}\n        method = undefined\n        dummy = ->\n        methods = ('assert,count,debug,dir,dirxml,error,exception,\n                   group,groupCollapsed,groupEnd,info,log,markTimeline,\n                   profile,profileEnd,time,timeEnd,trace,warn').split ','\n\n        console[method] = console[method] or dummy while method = methods.pop()\n    )()\n)()\n","module.exports = class BaseView extends Backbone.View\n\n    template: ->\n\n    initialize: ->\n\n    getRenderData: ->\n        model: @model?.toJSON()\n\n    render: ->\n        @beforeRender()\n        @$el.html @template(@getRenderData())\n        @afterRender()\n        @\n\n    beforeRender: ->\n\n    afterRender: ->\n\n    destroy: ->\n        @undelegateEvents()\n        @$el.removeData().unbind()\n        @remove()\n        Backbone.View::remove.call @\n","# Make ajax request more easy to do.\n# Expected callbacks: success and error\nexports.request = (type, url, data, callbacks) ->\n\n    success = callbacks.success or (res) -> callbacks null, res\n    error = callbacks.error or (err) -> callbacks err\n\n\n    $.ajax\n        type: type\n        url: url\n        data: data\n        success: success\n        error: error\n\n# Sends a get request with data as body\n# Expected callbacks: success and error\nexports.get = (url, callbacks) ->\n    exports.request \"GET\", url, null, callbacks\n\n# Sends a post request with data as body\n# Expected callbacks: success and error\nexports.post = (url, data, callbacks) ->\n    exports.request \"POST\", url, data, callbacks\n\n# Sends a put request with data as body\n# Expected callbacks: success and error\nexports.put = (url, data, callbacks) ->\n    exports.request \"PUT\", url, data, callbacks\n\n# Sends a delete request with data as body\n# Expected callbacks: success and error\nexports.del = (url, callbacks) ->\n    exports.request \"DELETE\", url, null, callbacks\n","BaseView = require 'lib/base_view'\n\n# View that display a collection of subitems\n# used to DRY views\n# Usage : new ViewCollection(collection:collection)\n# Automatically populate itself by creating a itemView for each item\n# in its collection\n\n# can use a template that will be displayed alongside the itemViews\n\n# itemView       : the Backbone.View to be used for items\n# itemViewOptions : the options that will be passed to itemViews\n# collectionEl : the DOM element's selector where the itemViews will\n#                be displayed. Automatically falls back to el if null\n\nmodule.exports = class ViewCollection extends BaseView\n\n    itemview: null\n\n    views: {}\n\n    template: -> ''\n\n    itemViewOptions: ->\n\n    collectionEl: null\n\n    # add 'empty' class to view when there is no subview\n    onChange: ->\n        @$el.toggleClass 'empty', _.size(@views) is 0\n\n    # can be overriden if we want to place the subviews somewhere else\n    appendView: (view) ->\n        @$collectionEl.append view.el\n\n    # bind listeners to the collection\n    initialize: ->\n        super\n        @views = {}\n        @listenTo @collection, \"reset\",   @onReset\n        @listenTo @collection, \"add\",     @addItem\n        @listenTo @collection, \"remove\",  @removeItem\n\n        if not @collectionEl?\n            collectionEl = el\n\n    # if we have views before a render call, we detach them\n    render: ->\n        view.$el.detach() for id, view of @views\n        super\n\n    # after render, we reattach the views\n    afterRender: ->\n        @$collectionEl = $(@collectionEl)\n        @appendView view.$el for id, view of @views\n        @onReset @collection\n        @onChange @views\n\n    # destroy all sub views before remove\n    remove: ->\n        @onReset []\n        super\n\n    # event listener for reset\n    onReset: (newcollection) ->\n        view.remove() for id, view of @views\n        newcollection.forEach @addItem\n\n    # event listeners for add\n    addItem: (model) =>\n        options = _.extend {}, {model: model}, @itemViewOptions(model)\n        view = new @itemview(options)\n        @views[model.cid] = view.render()\n        @appendView view\n        @onChange @views\n\n    # event listeners for remove\n    removeItem: (model) =>\n        @views[model.cid].remove()\n        delete @views[model.cid]\n\n        @onChange @views","AppView     = require 'views/app_view'\nPageView    = require 'views/page_view'\n\nmodule.exports = class Router extends Backbone.Router\n\n    # We try to maintain some continuity within the display, like still displaying\n    # a correct page even when we have an error\n\n    routes:\n      ''         : 'init'\n      'login'    : 'login'\n      'logout'   : 'logout'\n      ':pagename': 'page'\n\n    init: ->\n      mainView = new AppView()\n      mainView.renderIfNotLoggedIn()\n\n    login: ->\n      mainView = new AppView()\n      mainView.render()\n\n    page: (pagename) =>\n      if not pagename\n        pagename = \"\"\n      mainView = new PageView()\n      mainView.renderPage(pagename)\n\n    logout: =>\n      @url = ''\n      mainView = new PageView()\n      mainView.logout()\n","BaseView = require '../lib/base_view'\n\nmodule.exports = class AppView extends BaseView\n\n    el: 'body.application'\n    template: require('./templates/home')\n\n    canclick: true\n\n    events: =>\n        'submit'     : @loginCAS\n\n    renderIfNotLoggedIn: =>\n        $.ajax\n            url: 'login'\n            method: 'GET'\n            dataType: 'json'\n            success: (data) =>\n                if data.isLoggedIn\n                    @goToDefaultService()\n                else\n                    @render()\n\n    loginCAS: =>\n        if @canclick\n            @canclick = false\n            $('#status').html 'En cours'\n            $.ajax\n                url: 'login'\n                method: 'POST'\n                data:\n                    username: $('input#username').val()\n                    password: $('input#password').val()\n                dataType: 'json'\n                success: (data) =>\n                    if data.status\n                        @goToDefaultService()\n                    else\n                        $('#status').html 'Erreur'\n                        @canclick = true\n                error: =>\n                    $('#status').html 'Erreur HTTP'\n                    @canclick = true\n\n    goToDefaultService: =>\n        $.ajax\n            type: \"GET\"\n            dataType: \"text\"\n            async: false\n            url: 'defaultService'\n            success: (data) ->\n                window.location = \"#\" + data","BaseView  = require '../lib/base_view'\nAppView   = require 'views/app_view'\n\nmodule.exports = class PageView extends BaseView\n\n    el: 'body'\n    template: require './templates/page'\n\n    error: ''\n\n    events: =>\n        'click #closeError': 'hideError'\n        'keydown': 'hideError'\n\n    getRenderData: ->\n        res =\n            url: @url\n\n    renderPage: (pageid, oldpage) =>\n        if typeof oldpage is 'undefined'\n            oldpage =\n                url: 'moodle'\n        @pageid = pageid\n        return $.get 'authUrl/'+pageid, '', (data) =>\n            if data.error\n                if data.error is \"No user logged in\"\n                    window.location = \"#login\"\n                    return\n                else\n                    @error = data.error\n                    @url = \"\"\n            else\n                @url = data.url\n            document.title = window.location\n            @render()\n        , 'json'\n\n    logout: ->\n        $.get 'logout', '', =>\n            window.location = \"#login\"\n\n    afterRender: =>\n        if @error\n            @showError @error\n        $.ajax\n            type: \"GET\"\n            dataType: \"json\"\n            async: false\n            url: 'servicesList'\n            success: (data) =>\n                for key, service of data\n                    if service.clientServiceUrl is @pageid and service.clientRedirectPage\n                        @redirectUrl = service.clientRedirectPage\n                        if service.clientRedirectTimeOut\n                            setTimeout =>\n                                $(\"#app\").attr(\"src\", @redirectUrl)\n                            , service.clientRedirectTimeOut\n                        else\n                            $(\"#app\").one \"load\", =>\n                                $(\"#app\").attr(\"src\", @redirectUrl)\n                    li =\n                        '<li class=\"serviceButton\">\n                            <a href=\"#'+service.clientServiceUrl+'\">\n                                <i class=\"'+service.clientIcon+'\"></i>\n                                <span>'+service.displayName+'</span>\n                            </a>\n                        </li>'\n                    $(\"#servicesMenu\").append(li)\n            error: (err) =>\n                @showError err.status + \" : \" + err.statusText + \"<br>\" + err.responseText\n\n    showError: (err) =>\n        $(\"#errorText\").html err\n        $(\"#errors\").removeClass 'off-error'\n        $(\"#errors\").addClass 'on-error'\n\n    hideError: (e)=>\n        if e.type is \"click\" or e.keyCode is 13 or e.keyCode is 27\n            $(\"#errors\").removeClass 'on-error'\n            $(\"#errors\").addClass 'off-error'","var __templateData = function template(locals) {\nvar buf = [];\nvar jade_mixins = {};\nvar jade_interp;\n\nbuf.push(\"<div id=\\\"content\\\"><div id=\\\"home\\\"><h1>ENT ISEN</h1><h2>Merci de rentrer vos identifiants</h2><form onSubmit=\\\"return false\\\"><input type=\\\"text\\\" id=\\\"username\\\" placeholder=\\\"Nom d'utilisateur\\\"/><br/><input type=\\\"password\\\" id=\\\"password\\\" placeholder=\\\"Mot de passe\\\"/><br/><input type=\\\"submit\\\" id=\\\"submit\\\" value=\\\"Se connecter\\\"/></form><div id=\\\"status\\\"></div></div></div>\");;return buf.join(\"\");\n};\nif (typeof define === 'function' && define.amd) {\n  define([], function() {\n    return __templateData;\n  });\n} else if (typeof module === 'object' && module && module.exports) {\n  module.exports = __templateData;\n} else {\n  __templateData;\n}","var __templateData = function template(locals) {\nvar buf = [];\nvar jade_mixins = {};\nvar jade_interp;\nvar locals_ = (locals || {}),url = locals_.url;\nbuf.push(\"<div id=\\\"content\\\"><div id=\\\"errors\\\"><p>Erreur</p><p id=\\\"errorText\\\"></p><span id=\\\"closeError\\\" class=\\\"on-error\\\">ok</span></div><div id=\\\"sidebar\\\"><ul id=\\\"servicesMenu\\\"></ul><span class=\\\"exitButton\\\"><a href=\\\"#logout\\\"><i class=\\\"fa fa-sign-out\\\"></i><span>DÃ©connexion</span></a></span></div><iframe id=\\\"app\\\"\" + (jade.attr(\"src\", \"\" + (url) + \"\", true, false)) + \"></iframe></div>\");;return buf.join(\"\");\n};\nif (typeof define === 'function' && define.amd) {\n  define([], function() {\n    return __templateData;\n  });\n} else if (typeof module === 'object' && module && module.exports) {\n  module.exports = __templateData;\n} else {\n  __templateData;\n}"]}