{"version":3,"sources":["app/application.coffee","app/initialize.coffee","app/lib/app_helpers.coffee","app/lib/base_view.coffee","app/lib/client.coffee","app/lib/utils.coffee","app/lib/view_collection.coffee","app/router.coffee","app/views/app_view.coffee","app/views/logout_view.coffee","app/views/page_view.coffee","app/views/templates/home.jade","app/views/templates/logout.jade","app/views/templates/page.jade"],"names":[],"mappings":"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","file":"public/javascripts/app.js","sourcesContent":["module.exports =\n\n    initialize: ->\n        # Used in inter-app communication\n        #SocketListener = require '../lib/socket_listener'\n\n        # Routing management\n        Router = require 'router'\n        @router = new Router()\n        Backbone.history.start()\n\n        # Makes this object immuable.\n        Object.freeze this if typeof Object.freeze is 'function'","app = require 'application'\n\n# The function called from index.html\n$ ->\n    require 'lib/app_helpers'\n\n    app.initialize()","(() ->\n    # IIFE to avoid collisions with other variables\n    (->\n        # Make it safe to do console.log() always.\n        console = window.console = window.console or {}\n        method = undefined\n        dummy = ->\n        methods = ('assert,count,debug,dir,dirxml,error,exception,\n                   group,groupCollapsed,groupEnd,info,log,markTimeline,\n                   profile,profileEnd,time,timeEnd,trace,warn').split ','\n\n        console[method] = console[method] or dummy while method = methods.pop()\n    )()\n)()\n","module.exports = class BaseView extends Backbone.View\n\n    template: ->\n\n    initialize: ->\n\n    getRenderData: ->\n        model: @model?.toJSON()\n\n    render: ->\n        @beforeRender()\n        @$el.html @template(@getRenderData())\n        @afterRender()\n        @\n\n    beforeRender: ->\n\n    afterRender: ->\n\n    destroy: ->\n        @undelegateEvents()\n        @$el.removeData().unbind()\n        @remove()\n        Backbone.View::remove.call @\n","# Make ajax request more easy to do.\n# Expected callbacks: success and error\nexports.request = (type, url, data, callbacks) ->\n\n    success = callbacks.success or (res) -> callbacks null, res\n    error = callbacks.error or (err) -> callbacks err\n\n\n    $.ajax\n        type: type\n        url: url\n        data: data\n        success: success\n        error: error\n\n# Sends a get request with data as body\n# Expected callbacks: success and error\nexports.get = (url, callbacks) ->\n    exports.request \"GET\", url, null, callbacks\n\n# Sends a post request with data as body\n# Expected callbacks: success and error\nexports.post = (url, data, callbacks) ->\n    exports.request \"POST\", url, data, callbacks\n\n# Sends a put request with data as body\n# Expected callbacks: success and error\nexports.put = (url, data, callbacks) ->\n    exports.request \"PUT\", url, data, callbacks\n\n# Sends a delete request with data as body\n# Expected callbacks: success and error\nexports.del = (url, callbacks) ->\n    exports.request \"DELETE\", url, null, callbacks\n","module.exports = class Utils\n    importMailAccount: =>\n        #Probably will do something cool, like making possible to see magic unicorn flying in the sky.\n        #Whith a magic cheese. whitout it, that would not be so awsome.\n\n    importContacts: (callback) =>\n        $.ajax\n            type: \"GET\"\n            dataType: \"text\"\n            async: true\n            url: 'contacts'\n            complete: (xhr) =>\n                switch xhr.status\n                    when 202 then callback null\n                    else callback xhr.responseText\n\n    getImportContactStatus: (callback) ->\n        $.ajax\n            type: \"GET\"\n            dataType: \"json\"\n            async: true\n            url: 'contactImportStatus'\n            complete: (xhr) =>\n                if xhr.status is 200 \\\n                or xhr.status is 304 \\\n                or xhr.status is 201\n                    callback null, xhr.responseJSON\n                else callback xhr.responseText","BaseView = require 'lib/base_view'\n\n# View that display a collection of subitems\n# used to DRY views\n# Usage : new ViewCollection(collection:collection)\n# Automatically populate itself by creating a itemView for each item\n# in its collection\n\n# can use a template that will be displayed alongside the itemViews\n\n# itemView       : the Backbone.View to be used for items\n# itemViewOptions : the options that will be passed to itemViews\n# collectionEl : the DOM element's selector where the itemViews will\n#                be displayed. Automatically falls back to el if null\n\nmodule.exports = class ViewCollection extends BaseView\n\n    itemview: null\n\n    views: {}\n\n    template: -> ''\n\n    itemViewOptions: ->\n\n    collectionEl: null\n\n    # add 'empty' class to view when there is no subview\n    onChange: ->\n        @$el.toggleClass 'empty', _.size(@views) is 0\n\n    # can be overriden if we want to place the subviews somewhere else\n    appendView: (view) ->\n        @$collectionEl.append view.el\n\n    # bind listeners to the collection\n    initialize: ->\n        super\n        @views = {}\n        @listenTo @collection, \"reset\",   @onReset\n        @listenTo @collection, \"add\",     @addItem\n        @listenTo @collection, \"remove\",  @removeItem\n\n        if not @collectionEl?\n            collectionEl = el\n\n    # if we have views before a render call, we detach them\n    render: ->\n        view.$el.detach() for id, view of @views\n        super\n\n    # after render, we reattach the views\n    afterRender: ->\n        @$collectionEl = $(@collectionEl)\n        @appendView view.$el for id, view of @views\n        @onReset @collection\n        @onChange @views\n\n    # destroy all sub views before remove\n    remove: ->\n        @onReset []\n        super\n\n    # event listener for reset\n    onReset: (newcollection) ->\n        view.remove() for id, view of @views\n        newcollection.forEach @addItem\n\n    # event listeners for add\n    addItem: (model) =>\n        options = _.extend {}, {model: model}, @itemViewOptions(model)\n        view = new @itemview(options)\n        @views[model.cid] = view.render()\n        @appendView view\n        @onChange @views\n\n    # event listeners for remove\n    removeItem: (model) =>\n        @views[model.cid].remove()\n        delete @views[model.cid]\n\n        @onChange @views","AppView     = require 'views/app_view'\nPageView    = require 'views/page_view'\nLogoutView  = require 'views/logout_view'\n\nmodule.exports = class Router extends Backbone.Router\n\n    # We try to maintain some continuity within the display, like still displaying\n    # a correct page even when we have an error\n\n    routes:\n      ''         : 'init'\n      'login'    : 'login'\n      'logout'   : 'logout'\n      ':pagename': 'page'\n\n    init: ->\n      mainView = new AppView()\n      mainView.renderIfNotLoggedIn()\n\n    login: ->\n      mainView = new AppView()\n      mainView.render()\n\n    page: (pagename) =>\n      if not pagename\n        pagename = \"\"\n      mainView = new PageView()\n      mainView.renderPage(pagename)\n\n    logout: =>\n      @url = ''\n      mainView = new LogoutView()\n      mainView.render()","BaseView = require '../lib/base_view'\nUtils = require '../lib/utils'\nUtils = new Utils()\n\nmodule.exports = class AppView extends BaseView\n\n    el: 'body.application'\n    template: require('./templates/home')\n\n    events: =>\n        'submit'     : @loginCAS\n\n    renderIfNotLoggedIn: =>\n        $.ajax\n            url: 'login'\n            method: 'GET'\n            dataType: 'json'\n            complete: (xhr) =>\n                switch xhr.status\n                    when 200 then @goToDefaultService()\n                    when 401 then @render()\n                    when 500 then console.log xhr.responseJSON\n                    else console.log xhr.responseText\n\n    loginCAS: =>\n        $('#status').html 'En cours'\n        $.ajax\n            url: 'login'\n            method: 'POST'\n            data:\n                username: $('input#username').val()\n                password: $('input#password').val()\n            dataType: 'json'\n            success: (data) =>\n                if data.status\n                    $('input#username').attr(\"readonly\", \"\")\n                    $('input#password').attr(\"readonly\", \"\")\n\n                    @buildOperationTodoList()\n                    if @operations.length > 0\n                        $('#ImportingStatus').css('display', 'block')\n\n                        @currentOperation = 0\n                        @globalTimer = setInterval =>\n                            if @operations[@currentOperation].launched is false\n                                @operations[@currentOperation].functionToCall()\n                                @operations[@currentOperation].launched = true\n                            else if @operations[@currentOperation].terminated is true\n                                if @currentOperation+1 isnt @operations.length\n                                    @currentOperation++\n                                else\n                                    clearInterval @globalTimer\n                                    @setOperationName \"Opération(s) terminée(s)\"\n                                    @setStatusText \"Les bisounours préparent l'application, redirection iminente...\"\n                                    @setProgress 0\n                                    @setDetails \"\"\n\n                                    setTimeout =>\n                                        @goToDefaultService()\n                                    , 3000\n                        , 500\n                    else\n                        @goToDefaultService()\n                else\n                    $('#status').html 'Erreur'\n            error: =>\n                $('#status').html 'Erreur HTTP'\n\n    goToDefaultService: =>\n        $.ajax\n            type: \"GET\"\n            dataType: \"text\"\n            async: false\n            url: 'defaultService'\n            success: (data) ->\n                window.location = \"#\" + data\n\n    buildOperationTodoList: =>\n        @operations = new Array\n        @operations.push\n            functionToCall: @importMailAccount\n            launched: false\n            terminated: false\n\n        @operations.push\n            functionToCall: @importContacts\n            launched: false\n            terminated: false\n\n    setOperationName: (operationName) =>\n        $('#OperationName').html operationName\n\n    setStatusText: (statusText) =>\n        $('#statusText').html statusText\n\n    setProgress: (progress) =>\n        $('#progress').width progress + \"%\"\n\n    setDetails: (details) =>\n        $('#details').html details\n\n    importMailAccount: =>\n        Utils.importMailAccount()\n        console.log \"The magic unicorn is in the kitchen, eating a delicious apple.\"#Remplace with something usefull please :)\n        @setOperationName \"Importation de votre compte mail ISEN\"\n        @setStatusText \"Importation en cour...\"\n        @setDetails \"\"\n        @setProgress 0\n        setTimeout =>\n            @operations[@currentOperation].terminated = true\n        ,5000\n\n    importContacts: =>\n        @setOperationName \"Importation des contacts\"\n        @setStatusText \"Etape 1/2: Récupération des contacts depuis le serveur...\"\n        @setDetails \"\"\n        @setProgress 0\n\n        Utils.importContacts (err) =>\n            if err\n                @setDetails \"Une erreur est survenue: \" + err + \"<br>Vous pourez relancer l'importation des contacts depuis le menu configuration de l'application.\"\n                setTimeout =>\n                    @operations[@currentOperation].terminated = true\n                ,5000\n            else\n                @setStatusText \"Etape 2/2: Enregistrement des contacts dans votre cozy...\"\n                @lastStatus = new Object\n                @lastStatus.done = 0\n                Utils.getImportContactStatus @checkStatus\n\n                @timer = setInterval =>\n                    Utils.getImportContactStatus @checkStatus\n                ,200\n\n    checkStatus: (err, status) =>\n        if err\n            console.log err\n        else\n            if status.done > @lastStatus.done\n                @lastStatus = status\n                details =\n                status.done + \" contact(s) importés sur \" + status.total + \".\"\n                details += \"<br>\" + status.succes + \"contact(s) crée(s).\" if status.succes isnt 0\n                details += \"<br>\" + status.modified + \"contact(s) modifié(s).\" if status.modified isnt 0\n                details += \"<br>\" + status.notmodified + \"contact(s) non modifié(s).\" if status.notmodified isnt 0\n                details += \"<br>\" + status.error + \"contact(s) n'ont pu être importé(s).\" if status.error isnt 0\n\n                @setDetails details\n                @setProgress (100*status.done)/status.total\n\n                if status.done is status.total\n                    @setStatusText \"Importation des contacts terminés.\"\n                    clearInterval @timer\n\n                    setTimeout =>\n                        @operations[@currentOperation].terminated = true\n                    ,3000","BaseView  = require '../lib/base_view'\n\nmodule.exports = class LogoutView extends BaseView\n\n    el: 'body'\n    template: require './templates/logout'\n\n    events: =>\n\n    getRenderData: ->\n        res =\n            url: @url\n\n    beforeRender: =>\n        @serviceData = new Array\n        $.ajax\n            type: \"GET\"\n            dataType: \"json\"\n            async: false\n            url: 'servicesList'\n            success: (data) =>\n                for key, service of data\n                    if service.clientLogoutUrl\n                        @serviceData.push\n                            name: service.displayName\n                            logOutUrl: service.clientLogoutUrl\n                @logoutStatus =\n                    numServicesToLogOut: @serviceData.length + 1#+1 for server deco\n                    numServicesLoggedOut: 0\n            error: (err) =>\n                @serviceData.err = err\n\n    logout: ->\n\n\n    afterRender: =>\n        @timoutId = setTimeout =>\n            console.log \"Certains services n'ont pas répondus à temps sur leur url de déconnexion. Vous allez être tout de même redirigé sur la page de login.\"\n            window.location = \"#login\"\n        , 5000\n        console.log \"Déconnexion de l'application cozy...\"\n        $.ajax\n            type: \"GET\"\n            dataType: \"json\"\n            async: true\n            url: \"logout\"\n            success: (data) =>\n                if data.error\n                    console.log \"L'application cozy à renvoyée l'erreur suivante: \" + data.error\n                else\n                    console.log \"L'application cozy est déconnectée du serveur CAS.\"\n                    @checkLogout()\n            error: (err) =>\n                console.log \"Impossible de joindre l'application cozy: \" + err\n\n        if not @serviceData.err\n            for key, service of @serviceData\n                console.log 'Déconnexion du service ' + service.name + ' sur l\\'url ' + service.logOutUrl + ' ...'\n                onLoad = =>\n                    sname = service.name\n                    return =>\n                        console.log 'Service ' + sname + ' déconecté.'\n                        @checkLogout()\n                $(\"#logoutIframes\").append('<iframe src=\"' + service.logOutUrl + '\"></iframe>')\n                .children().last().one \"load\", onLoad()\n        else\n            console.log 'Une erreur est survenue lors de la récupération de la liste des services: ' + @serviceData.err\n\n    checkLogout: =>\n        @logoutStatus.numServicesLoggedOut++\n        if @logoutStatus.numServicesLoggedOut is @logoutStatus.numServicesToLogOut\n            console.log 'Déconnexion de tout les services et du serveur CAS effectuée.'\n            clearTimeout(@timoutId)\n            window.location = \"#login\"","BaseView  = require '../lib/base_view'\nAppView   = require 'views/app_view'\n\nmodule.exports = class PageView extends BaseView\n\n    el: 'body'\n    template: require './templates/page'\n\n    error: ''\n\n    events: =>\n        'click #closeError': 'hideError'\n        'keydown': 'hideError'\n\n    getRenderData: ->\n        res =\n            url: @url\n\n    renderPage: (pageid) =>\n        @pageid = pageid\n        $.ajax\n            type: \"GET\"\n            dataType: \"json\"\n            async: false\n            url: 'authUrl/'+pageid\n            complete: (xhr) =>\n                switch xhr.status\n                    when 401 then window.location = \"#login\"\n                    when 400\n                        #@error = t(\"unknown service\")+\" \"+pageid\n                        @error = \"Unknown service \"+pageid\n                        @url = \"\"\n                    when 200 then @url = xhr.responseJSON.url\n                    else @error = xhr.responseJSON || xhr.responseText\n                document.title = window.location\n                @render()\n\n    afterRender: =>\n        if @error\n            @showError @error\n        $.ajax\n            type: \"GET\"\n            dataType: \"json\"\n            async: false\n            url: 'servicesList'\n            complete: (xhr) =>\n                if xhr.status is 200\n                    data = xhr.responseJSON\n                    for key, service of data\n                        idCurrentService = \"\"\n                        if service.clientServiceUrl is @pageid\n                            idCurrentService = ' id=\"currentService\"'\n                            if service.clientRedirectPage\n                                @redirectUrl = service.clientRedirectPage\n                                if service.clientRedirectTimeOut\n                                    setTimeout =>\n                                        $(\"#app\").attr(\"src\", @redirectUrl)\n                                    , service.clientRedirectTimeOut\n                                else\n                                    $(\"#app\").one \"load\", =>\n                                        $(\"#app\").attr(\"src\", @redirectUrl)\n                        li =\n                            '<li class=\"serviceButton\"'+idCurrentService+'>\n                                <a href=\"#'+service.clientServiceUrl+'\">\n                                    <i class=\"'+service.clientIcon+'\"></i>\n                                    <span>'+service.displayName+'</span>\n                                </a>\n                            </li>'\n                        $(\"#servicesMenu\").append(li)\n                else\n                    data = xhr\n                    @showError data.status + \" : \" + data.statusText + \"<br>\" + data.responseText\n\n    showError: (err) =>\n        $(\"#errorText\").html err\n        $(\"#errors\").removeClass 'off-error'\n        $(\"#errors\").addClass 'on-error'\n\n    hideError: (e)=>\n        if e.type is \"click\" or e.keyCode is 13 or e.keyCode is 27\n            $(\"#errors\").removeClass 'on-error'\n            $(\"#errors\").addClass 'off-error'","var __templateData = function template(locals) {\nvar buf = [];\nvar jade_mixins = {};\nvar jade_interp;\n\nbuf.push(\"<div id=\\\"content\\\"><div id=\\\"home\\\"><h1>ENT ISEN</h1><h2>Merci de rentrer vos identifiants</h2><form onSubmit=\\\"return false\\\"><input type=\\\"text\\\" id=\\\"username\\\" placeholder=\\\"Nom d'utilisateur\\\"/><br/><input type=\\\"password\\\" id=\\\"password\\\" placeholder=\\\"Mot de passe\\\"/><br/><input type=\\\"submit\\\" id=\\\"submit\\\" value=\\\"Se connecter\\\"/></form><div id=\\\"status\\\"></div><div id=\\\"ImportingStatus\\\"><img id=\\\"logo\\\" src=\\\"isenlogo.png\\\"/><p id=\\\"OperationName\\\"></p><p id=\\\"statusText\\\"></p><div id=\\\"progressParent\\\"><div id=\\\"progress\\\"></div></div><p id=\\\"details\\\"></p></div></div></div>\");;return buf.join(\"\");\n};\nif (typeof define === 'function' && define.amd) {\n  define([], function() {\n    return __templateData;\n  });\n} else if (typeof module === 'object' && module && module.exports) {\n  module.exports = __templateData;\n} else {\n  __templateData;\n}","var __templateData = function template(locals) {\nvar buf = [];\nvar jade_mixins = {};\nvar jade_interp;\n\nbuf.push(\"<div id=\\\"home\\\"><div id=\\\"status\\\">Déconnexion...</div><div id=\\\"logoutIframes\\\" style=\\\"display:none\\\"></div></div>\");;return buf.join(\"\");\n};\nif (typeof define === 'function' && define.amd) {\n  define([], function() {\n    return __templateData;\n  });\n} else if (typeof module === 'object' && module && module.exports) {\n  module.exports = __templateData;\n} else {\n  __templateData;\n}","var __templateData = function template(locals) {\nvar buf = [];\nvar jade_mixins = {};\nvar jade_interp;\nvar locals_ = (locals || {}),url = locals_.url;\nbuf.push(\"<div id=\\\"content\\\"><div id=\\\"errors\\\"><p>Erreur</p><p id=\\\"errorText\\\"></p><span id=\\\"closeError\\\" class=\\\"on-error\\\">ok</span></div><div id=\\\"sidebar\\\"><ul id=\\\"servicesMenu\\\"></ul><span class=\\\"exitButton\\\"><a href=\\\"#logout\\\"><i class=\\\"fa fa-sign-out\\\"></i><span>Déconnexion</span></a></span></div><iframe id=\\\"app\\\"\" + (jade.attr(\"src\", \"\" + (url) + \"\", true, false)) + \"></iframe></div>\");;return buf.join(\"\");\n};\nif (typeof define === 'function' && define.amd) {\n  define([], function() {\n    return __templateData;\n  });\n} else if (typeof module === 'object' && module && module.exports) {\n  module.exports = __templateData;\n} else {\n  __templateData;\n}"]}